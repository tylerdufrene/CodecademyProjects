import codecademylib
import pandas as pd

df = pd.read_csv('clicks.csv')
print(df.head())

df['is_purchase'] = df['click_day'].apply(lambda x: 'Purchase' if pd.notnull(x) else 'No Purchase')

purchase_counts = df.groupby(['group','is_purchase']).user_id.count().reset_index()
print(df.head())
	
print purchase_counts


from scipy.stats import chi2_contingency

contingency = [[316, 1350],
               [183, 1483], 
               [83, 1583]]

chi2, pvalue, dof, excluded = chi2_contingency(contingency)

print pvalue

is_significant = True
